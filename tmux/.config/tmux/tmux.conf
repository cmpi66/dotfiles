##################################################### Options #################################################


# set -g default-command  /bin/fish
# set -g default-shell  /bin/fish

# set-option -g default-shell  /bin/fish
set -g default-command  "fish -l"

# tmux doesn't exit after killing window
set-option -g detach-on-destroy off

# utf8 is on
setw -q -g utf8 on

# Use the mouse
set -g mouse on

# Automatically rename windows based on the application within
setw -g automatic-rename on

# Renumber windows if others are closed
set -g renumber-windows on

# Use titles in tabs
set -g set-titles on

# Sticky time after repeated commands
set -sg repeat-time 500

set -ga terminal-overrides ",xterm-256color*:Tc"
set -s escape-time 0

# Increase scrollback buffer size from 2000 to 50000 lines
set -g history-limit 50000

# Increase tmux messages display duration from 750ms to 4s
set -g display-time 4000

# Refresh 'status-left' and 'status-right' more often, from every 15s to 5s
set -g status-interval 1

# Focus events enabled for terminals that support them
set -g focus-events on

# Super useful when using "grouped sessions" and multi-monitor setup
setw -g aggressive-resize on

# Start numbering at 1 for windows and panes
set -g base-index 1
setw -g pane-base-index 1

# set -g status-style 'bg=#494d64 fg=#a6da95'
# set -g status-position top


################################################################ keybinds #######################################################


# Note: that the -n means we can ignore the ctrl-a prefix
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix
bind a last-window

bind-key r run-shell " \
			tmux source-file ~/.config/tmux/tmux.conf > /dev/null; \
			tmux display-message 'Sourced tmux_config!'"

set-window-option -g mode-keys vi
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# stop confirmation prompt
bind-key w kill-window
bind-key x kill-pane

bind-key W choose-window
bind-key T clock-mode

# its funny -h is vertical split and -v is horizontal. Makes no sense.
bind v split-window -h
bind H split-window -v
bind k kill-pane -a                  # Kill all panes except for the current one

# vim-like pane switching
bind -r ^ last-window
bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

# Easier and faster switching between next/prev window
bind -n C-p previous-window
bind -n C-n next-window

# Smart pane switching with awareness of Vim splits.
# From https://github.com/christoomey/vim-tmux-navigator
# is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
# | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
# bind-key -n 'C-h' if-shell "$is_vim" "send-keys C-h" "select-pane -L"
# bind-key -n 'C-j' if-shell "$is_vim" "send-keys C-j" "select-pane -D"
# bind-key -n 'C-k' if-shell "$is_vim" "send-keys C-k" "select-pane -U"
# bind-key -n 'C-l' if-shell "$is_vim" "send-keys C-l" "select-pane -R"


# forget the find window.  That is for chumps
bind-key -r f run-shell "tmux neww ~/.local/bin/tmux-sessionizer"

bind-key -r i run-shell "tmux neww tmux-cht.sh"
# bind-key -r G run-shell "~/.local/bin/tmux-sessionizer ~/work/nrdp"
# bind-key -r C run-shell "~/.local/bin/tmux-sessionizer ~/work/tvui"
# bind-key -r R run-shell "~/.local/bin/tmux-sessionizer ~/work/milo"
# # bind-key -r L run-shell "~/.local/bin/tmux-sessionizer ~/work/hpack"
# bind-key -r H run-shell "~/.local/bin/tmux-sessionizer ~/personal/vim-with-me"
# bind-key -r T run-shell "~/.local/bin/tmux-sessionizer ~/personal/refactoring.nvim"
# bind-key -r N run-shell "~/.local/bin/tmux-sessionizer ~/personal/harpoon"
# bind-key -r S run-shell "~/.local/bin/tmux-sessionizer ~/personal/developer-productivity"


################################################ plugins ########################################################################


set -g @plugin 'rwxd/catppuccin-tmux'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin '27medkamal/tmux-session-wizard'
set -g @plugin 'jaclu/tmux-menus'
set -g @plugin 'MunifTanjim/tmux-mode-indicator'    # Display current tmux mode
# set -g @plugin 'ofirgall/tmux-window-name'        # can't get this to work; tried without catpuccin plugin and nothing
set -g @plugin 'tmux-plugins/tmux-resurrect'


################################################ plugin options #################################################################


set -g @catppuccin_flavour 'macchiato' # or frappe, macchiato, mocha, latte
set -g @session-wizard 't'
set -g @resurrect-capture-pane-contents 'on'
set -g @menus_location_x 'C'
set -g @menus_location_y 'C'

set -g @resurrect-dir "~/.config/tmux/resurrect"
set -g @resurrect-save 'S'                          # Save the session
set -g @resurrect-restore 'R'                       # Reload the session


# prompt to display when tmux prefix key is pressed
set -g @mode_indicator_prefix_prompt ' WAIT '

# prompt to display when tmux is in copy mode
set -g @mode_indicator_copy_prompt ' COPY '

# prompt to display when tmux has synchronized panes
set -g @mode_indicator_sync_prompt ' SYNC '

# prompt to display when tmux is in normal mode
set -g @mode_indicator_empty_prompt ' TMUX '

# style values for prefix prompt
set -g @mode_indicator_prefix_mode_style 'bg=red,fg=#1e2030'

# style values for copy prompt
set -g @mode_indicator_copy_mode_style 'bg=magenta,fg=#1e2030'

# style values for sync prompt
set -g @mode_indicator_sync_mode_style 'bg=pink,fg=#1e2030'

# style values for empty prompt
set -g @mode_indicator_empty_mode_style 'bg=#8aadf4,fg=#1e2030'


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.config/tmux/plugins/tpm/tpm'
